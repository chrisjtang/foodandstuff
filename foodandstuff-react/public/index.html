<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="theme-color" content="#000000" />
    <meta
      name="description"
    />
    <link rel="apple-touch-icon" href="%PUBLIC_URL%/logo192.png" />
    <link rel="manifest" href="%PUBLIC_URL%/manifest.json" />
    <title>Disqus React SSO Demo</title>
  </head>
  <body>
    <div id="root">
    <script>
        /**
         *  RECOMMENDED CONFIGURATION VARIABLES: EDIT AND UNCOMMENT THE SECTION BELOW TO INSERT DYNAMIC VALUES FROM YOUR PLATFORM OR CMS.
         *  LEARN WHY DEFINING THESE VARIABLES IS IMPORTANT: https://disqus.com/admin/universalcode/#configuration-variables
         */

        var disqus_config = function () {
            this.page.url = 'https://disqus-sso-demo.glitch.me/';  // Replace PAGE_URL with your page's canonical URL variable
            this.page.identifier = '1 https://disqus-sso-demo.glitch.me/'; // Replace PAGE_IDENTIFIER with your page's unique identifier variable
            this.page.title = 'Disqus SSO quick start';
            this.page.api_key = 'IrsWOMVmYfDfTq7IJ5fXMA2Ix99nB30EF7cP77SDgIrGyoQna1wXwU42wx17xRjN';
            this.sso = {
              name:   "SampleNews",
              button:  "http://example.com/images/samplenews.gif",
              icon:     "http://example.com/favicon.png",
              url:        "http://example.com/login/",
              logout:  "http://example.com/logout/",
              profile_url: "http://example.com/profileUrlTemplate/{username}",
              width:   "800",
              height:  "400"
            };
        };

        (function() {  // DON'T EDIT BELOW THIS LINE
            var d = document, s = d.createElement('script');

            s.src = '//ssoglitch.disqus.com/embed.js';

            s.setAttribute('data-timestamp', +new Date());
            (d.head || d.body).appendChild(s);
        })();   

        /* * * Disqus Reset Function * * */
        var reset = function (newAuth) {
            DISQUS.reset({
                reload: true,
                config: function () {
                    this.page.remote_auth_s3 = newAuth;
                }
            });
        };
        
        /** 
         * Makes call to server to get payload and reset Disqus
         * DISQUS.reset() is not required for SSO but can used to refresh Disqus with a new user
         */
        function login() {
            $.get('/login', function(payload) {
              $('<p></p>').text('payload: ').appendTo('#disqus_thread');
              $('<p></p>').text(payload.auth).appendTo('#disqus_thread');
              $('<p></p>').text('public key: ').appendTo('#disqus_thread');
              $('<p></p>').text(payload.pubKey).appendTo('#disqus_thread');
              reset(payload.auth)
            });
        }
      </script>
    </div>
    <noscript>You need to enable JavaScript to run this app.</noscript>
    <!-- <div id="root"></div> -->
  </body>
</html>
